x_data: [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0,
         10.5, 11.0, 11.5, 12.0, 12.5, 13.0, 13.5, 14.0, 14.5, 15.0, 15.5, 16.0, 16.5, 17.0, 17.5, 18.0, 18.5, 19.0,
         19.5, 20.0, 20.5, 21.0, 21.5, 22.0, 22.5, 23.0, 23.5, 24.0, 24.5, 25.0, 25.5, 26.0, 26.5, 27.0, 27.5, 28.0,
         28.5, 29.0, 29.5, 30.0, 30.5, 31.0, 31.5, 32.0, 32.5, 33.0, 33.5, 34.0, 34.5, 35.0, 35.5, 36.0, 36.5, 37.0,
         37.5, 38.0, 38.5, 39.0, 39.5, 40.0, 40.5, 41.0, 41.5, 42.0, 42.5, 43.0, 43.5, 44.0, 44.5, 45.0, 45.5, 46.0,
         46.5, 47.0, 47.5, 48.0, 48.5, 49.0, 49.5, 50.0, 50.5, 51.0, 51.5, 52.0, 52.5, 53.0, 53.5, 54.0, 54.5, 55.0,
         55.5, 56.0, 56.5, 57.0, 57.5, 58.0, 58.5, 59.0, 59.5, 60.0]
x_errors: 0.001

y_data: [0.6055317575993914, 0.5169107902610475, 0.3293169273559535, 0.06375859733814328, -0.22640917641452488,
         -0.4558011426302008, -0.5741274235093591, -0.5581292464350779, -0.4123919729458466, -0.16187396188197636,
         0.11128294449725282, 0.3557032748758762, 0.5123991632742368, 0.5426212570679745, 0.441032201346871,
         0.2530635717934812, -0.018454841476861578, -0.27767282674995675, -0.4651897678670606, -0.5496969201663507,
         -0.5039723480612176, -0.32491507193649194, -0.07545061334934718, 0.17868596924060803, 0.38816743920465974,
         0.5307390166315159, 0.5195411750524918, 0.3922352276601664, 0.1743316249378316, -0.08489324112691513,
         -0.31307737388477896, -0.47061848549403956, -0.5059137659253059, -0.4255733083473707, -0.24827692102709906,
         -0.013334081799533964, 0.21868390151118114, 0.40745363855032496, 0.4900638626421252, 0.4639947376885959,
         0.3160179896333209, 0.11661884242058931, -0.15370888958327286, -0.32616191426973545, -0.45856921225721586,
         -0.46439857887558106, -0.3685539265001533, -0.1830244989818371, 0.03835530881316253, 0.27636300051486506,
         0.4163001580121898, 0.45791960756716926, 0.4133277046353799, 0.2454571744527809, 0.02843505139404641,
         -0.17995259849041545, -0.3528170613993332, -0.4432670688586229, -0.4308872405896063, -0.3026153676925856,
         -0.10460001285649327, 0.10576999137260902, 0.2794125634785019, 0.39727960494083775, 0.44012013094335295,
         0.33665573392945614, 0.19241116925921273, -0.01373255454051425, -0.2288093781464643, -0.36965277845455136,
         -0.4281953074871928, -0.3837254105792804, -0.2439384794237307, -0.05945292033865969, 0.12714573185667402,
         0.31127632080817996, 0.38957820781361946, 0.4022425989547513, 0.2852587536434507, 0.12097975879552739,
         -0.06442727622110235, -0.25077071692351, -0.3414562050547135, -0.3844271968533089, -0.3344326061358699,
         -0.1749451011511041, -0.016716872087832926, 0.18543436492361495, 0.322914548974734, 0.37225887677620817,
         0.3396788239855797, 0.254332254048965, 0.0665429944525343, -0.11267963115652598, -0.2795347352658008,
         -0.37651751469292644, -0.3654799155251143, -0.28854786660062454, -0.14328549945642755, 0.04213065692623846,
         0.2201386996949766, 0.32591680654151617, 0.3421258708802321, 0.32458251078266503, 0.18777342536595865,
         0.032971092778669095, -0.13521542014013244, -0.3024666212766573, -0.34121930021830144, -0.33201664443451445,
         -0.21960116119767256, -0.07735846981040519, 0.09202435934084172, 0.24410808130924241, 0.3310159788871507,
         0.34354629209994936, 0.2765230394100408, 0.12467034370454594, -0.012680322294530635, -0.1690136862958978,
         -0.27753009059653394]
y_errors: 0.01

# Because the model function is oscillating the fit needs to be initialized with near guesses for unconstrained
# parameters in order to converge.
# To use starting values for the fit, specify them as default values in the fit function.
model_function: |
    def damped_harmonic_oscillator(x, y_0=1.0, l=1.0, r=1.0, g=9.81, c=0.01):
        # Model function for a pendulum as a one-dimensional, damped harmonic oscillator with zero initial speed
        # x = time, y_0 = initial_amplitude, l = length of the string,
        # r = radius of the steel ball, g = gravitational acceleration, c = damping coefficient
        l_total = l + r  # effective length of the pendulum = length of the string + radius of the steel ball
        omega_0 = np.sqrt(g / l_total)  # phase speed of an undamped pendulum
        omega_d = np.sqrt(omega_0 ** 2 - c ** 2)  # phase speed of a damped pendulum
        return y_0 * np.exp(-c * x) * (np.cos(omega_d *x) + c / omega_d * np.sin(omega_d * x))

parameter_constraints:  # add parameter constraints
- index: 0              # index 0 corresponds to the first free variable of the fit function, here y_0
  relative: true        # Make constraint uncertainty relative to value.
  type: simple
  uncertainty: 0.006
  value: 0.6            # y_0 = 0.6+-0.6%

- index: 1              # index 1 corresponds to the second free variable of the fit function, here l
  relative: false       # Uncertainty is absolute.
  type: simple
  uncertainty: 0.001
  value: 10.0           # l = 10.0+-0.001

- index: 2              # index 2 corresponds to r
  relative: false
  type: simple
  uncertainty: 0.001    # r = 0.052+-0.001
  value: 0.052
